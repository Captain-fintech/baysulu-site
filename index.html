<!doctype html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>BaySulu — Monthly Rentals UAE (XL+)</title>

  <!-- Fonts & Tailwind (CDN) -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet"/>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { sanserif: ['Inter','system-ui','sans-serif'] },
          colors: { brand:'#16543C', sand:'#F7F5EF', ink:'#0B1F1A' }
        }
      }
    }
  </script>

  <style>
    :root { --brand:#16543C; --sand:#F7F5EF; --ink:#0B1F1A; }
    body{font-family:var(--font-sanserif,Inter,system-ui,sans-serif)}
    .container-xx{max-width:1180px}
    .chip{padding:.25rem .6rem;border-radius:999px;font-size:.75rem}
    .badge{display:inline-block;padding:.4rem .6rem;border-radius:.6rem;font-size:.75rem}
    .nav-link{padding:.35rem .65rem;border-radius:.6rem}
    .nav-link.active{background:var(--brand);color:#fff}
    .shadow-soft{box-shadow:0 6px 18px rgba(0,0,0,.06)}
    .btn-light{background:#fff;color:#0b1220;border:1px solid #e5e7eb}
    .logo-img{height:56px;width:auto}
    @media (min-width:768px){ .logo-img{height:68px} }
    .banner-text{font:14px/1.45 Inter,system-ui,sans-serif}
    .form-card{max-width:520px;margin:18px auto;padding:16px;border:1px solid #e5e7eb;border-radius:16px;background:#fff}
    .wa-fab{
      position:fixed; right:12px; bottom:12px; width:60px; height:60px;
      border-radius:9999px; display:flex; align-items:center; justify-content:center;
      background:#25D366; color:#fff; box-shadow:0 10px 24px rgba(0,0,0,.25); z-index:1100;
    }
    @media (max-width:420px){ .wa-fab{ right:8px; bottom:8px; width:56px; height:56px } }
    @media (min-width:768px){ .wa-fab{ right:20px; bottom:20px; width:56px; height:56px } }

    /* Dark mode — всё читаемо */
    .dark body{ background:#0b1220; color:#e6e9ef }
    .dark .bg-sand{ background:#0f172a }
    .dark .p-3, .dark .p-5, .dark .p-6 { background:#0f172a !important }
    .dark .text-gray-600{ color:#a7b0bd !important }
    .dark .text-gray-700{ color:#c5cedb !important }
    .dark .badge, .dark .chip{ background:#1f2937 !important; color:#e6e9ef !important }
    .dark .demo-banner{ background:#172036 !important; border-color:#263043 !important; color:#e6e9ef !important }
    .dark header{ background:#0f172a; border-color:#1f2937 }
    .dark .nav-link{ color:#e6e9ef !important; border-color:rgba(255,255,255,.12) !important }
    .dark .nav-link:hover{ background:rgba(236,253,245,.10) }
    .dark .btn-light{ background:#e6e9ef !important; color:#0f172a !important; border-color:#334155 !important }
    .dark header img{ filter:contrast(1.08) saturate(1.08) }
  </style>
</head>
<body class="bg-white text-ink">

<!-- ===== Config (edit values only) ===== -->
<script>
  const BRAND_NAME="BaySulu";
  const WHATSAPP_NUMBER="971500000000"; // no '+'
  const BRAND_TAGLINE_EN="Pay monthly instead of 4–6 cheques.";
  const BRAND_TAGLINE_AR="ادفع شهريًا بدلًا من 4–6 شيكات.";
  const AGENT_COMMISSION_TX="AED 1,200–2,000 per deal";
  const PLATFORM_FEE_TX="~4–5% platform fee (demo)";
</script>

<!-- ===== NAVBAR ===== -->
<header class="sticky top-0 z-50 border-b bg-white/90 backdrop-blur">
  <div class="container-xx mx-auto px-4 py-3 flex items-center justify-between">
    <a href="/" class="flex items-center gap-2">
      <img id="brandLogo" src="./public/images/IMG_0014.jpeg" alt="BaySulu" class="logo-img"
           onerror="this.style.display='none';document.getElementById('brandText').style.display='inline-block'">
      <span id="brandText" class="font-extrabold text-2xl text-[color:var(--brand)]" style="display:none">BaySulu</span>
    </a>

    <nav class="hidden md:flex items-center gap-2">
      <a href="#features" class="nav-link" data-i18n="nav_features">Features</a>
      <a href="#how"      class="nav-link" data-i18n="nav_how">How it works</a>
      <a href="#listings" class="nav-link" data-i18n="nav_listings">Listings</a>
      <a href="#portals"  class="nav-link" data-i18n="nav_portals">Portals</a>
      <a href="#agents"   class="nav-link" data-i18n="agents_h2">Agents</a>
      <a href="#pricing"  class="nav-link" data-i18n="pricing_h2">Pricing</a>
      <a href="#installments" class="nav-link">Calculator</a>
      <a href="#viewings" class="nav-link">Viewings</a>
      <a href="#chat"     class="nav-link">Chat</a>
      <a href="#faq"      class="nav-link" data-i18n="nav_faq">FAQ</a>
    </nav>

    <div class="flex items-center gap-2">
      <button id="lang-en" class="px-2 py-1 border rounded">EN</button>
      <button id="lang-ar" class="px-2 py-1 border rounded">AR</button>
      <button id="lang-ru" class="px-2 py-1 border rounded">RU</button>
      <button id="lang-zh" class="px-2 py-1 border rounded">中</button>
      <button id="themeToggle" class="px-2 py-1 border rounded">Dark</button>
    </div>
  </div>
</header>

<!-- ===== DEMO BANNER ===== -->
<div class="mx-auto container-xx px-4 mt-3">
  <div class="demo-banner rounded-xl p-3 border banner-text">
    <span id="banner-i18n">Demo only: This is a demonstration. All payments, calendars and chats are simulated (no backend).</span>
  </div>
</div>

<!-- ===== HERO ===== -->
<section class="relative overflow-hidden">
  <div class="absolute inset-0 bg-gradient-to-br from-emerald-600 via-emerald-700 to-brand"></div>
  <div class="container-xx relative z-10 mx-auto px-4 py-16 md:py-20 grid md:grid-cols-2 gap-10 items-center text-white">
    <div>
      <div class="chip bg-white/20">Fintech · Rentals UAE</div>
      <h1 class="mt-4 text-4xl md:text-5xl font-extrabold leading-tight" data-i18n="hero_h1">
        Monthly rentals in Abu Dhabi &amp; UAE
      </h1>
      <p class="mt-4 text-white/90 text-lg" id="tagline">Pay monthly instead of 4–6 cheques.</p>
      <div class="mt-6 flex flex-wrap gap-3">
        <a href="#register" class="cta-strong btn-light">Get started — Join beta</a>
        <a href="#how" class="px-5 py-3 rounded-xl ring-1 ring-white/70 text-white" data-i18in="cta_secondary">How it works</a>
      </div>
      <div class="mt-6 flex flex-wrap gap-2 text-sm">
        <span class="badge bg-white/15">Secure payments via <b>YXZ</b> (3DS, tokenized)</span>
        <span class="badge bg-white/15">Optional deposit insurance by <b>XYZ</b></span>
      </div>
    </div>
    <div class="rounded-3xl shadow-soft overflow-hidden">
      <img class="w-full h-[320px] object-cover" alt="Abu Dhabi"
           src="https://images.unsplash.com/photo-1505691938895-1758d7feb511?q=80&w=1600&auto=format&fit=crop">
    </div>
  </div>
</section>

<!-- ===== FEATURES ===== -->
<section id="features" class="container-xx mx-auto px-4 py-14">
  <h2 class="text-3xl font-extrabold" data-i18n="features_h2">Why BaySulu</h2>
  <p class="text-gray-600 mt-2" data-i18n="features_p">Clear value for tenants, landlords, and agents.</p>
  <div class="grid md:grid-cols-3 gap-6 mt-8">
    <div class="p-5 border rounded-2xl shadow-soft">
      <div class="badge bg-brand/10 text-brand" data-i18n="f1_badge">Monthly plan</div>
      <h3 class="font-semibold text-lg" data-i18n="f1_h3">Pay monthly instead of cheques</h3>
      <p class="text-gray-600" data-i18n="f1_p">Auto-debit via YXZ; 3-D Secure for safety. No card data stored on BaySulu.</p>
    </div>
    <div class="p-5 border rounded-2xl shadow-soft">
      <div class="badge bg-brand/10 text-brand" data-i18n="f2_badge">Verified</div>
      <h3 class="font-semibold text-lg" data-i18n="f2_h3">Verified listings &amp; moderation</h3>
      <p class="text-gray-600" data-i18n="f2_p">Manual review at MVP stage. Quality photos and clear terms.</p>
    </div>
    <div class="p-5 border rounded-2xl shadow-soft">
      <div class="badge bg-brand/10 text-brand" data-i18n="f3_badge">Insurance</div>
      <h3 class="font-semibold text-lg" data-i18n="f3_h3">Deposit insurance (optional)</h3>
      <p class="text-gray-600" data-i18n="f3_p">Add policy via partner XYZ; landlords hand over keys with confidence.</p>
    </div>
  </div>
</section>

<!-- ===== HOW IT WORKS (VIDEO) ===== -->
<section id="how" class="container-xx mx-auto px-4 py-14">
  <div style="max-width:520px;margin:24px auto;text-align:center">
    <video controls playsinline preload="metadata"
           src="./public/videos/baysulu_how_it_works_dual.mp4"
           style="width:100%;border-radius:16px;border:1px solid #e5e7eb"></video>
    <small style="display:block;color:#6b7280;margin-top:6px" data-i18n="how_caption">
      Browse → Plan → Checkout → Chat → Move-in (demo)
    </small>
  </div>
  <h2 class="text-3xl font-extrabold" data-i18n="how_h2">How it works</h2>
</section>

<!-- ===== REGISTRATION ===== -->
<section id="register" class="container-xx mx-auto px-4 py-14">
  <h2 class="text-3xl font-extrabold" data-i18n="register_h2">Create your BaySulu account (demo)</h2>
  <div class="form-card">
    <form id="reg-form" class="grid md:grid-cols-2 gap-3">
      <input id="reg-name" class="border p-2 rounded" placeholder="Full name" required>
      <input id="reg-email" type="email" class="border p-2 rounded" placeholder="Email" required>
      <input id="reg-phone" class="border p-2 rounded" placeholder="Phone" required>
      <input id="reg-pass" type="password" class="border p-2 rounded" placeholder="Password" required>
      <button class="px-4 py-2 bg-brand text-white rounded md:col-span-2">Register (demo)</button>
    </form>
    <div id="reg-ok" class="text-green-500 mt-2 hidden">✔ Registered (demo). You can now book a viewing &amp; chat.</div>
  </div>
</section>

<!-- ===== LISTINGS ===== -->
<section id="listings" class="container-xx mx-auto px-4 py-14">
  <div class="flex items-end justify-between">
    <div>
      <h2 class="text-3xl font-extrabold" data-i18n="listings_h2">Featured listings</h2>
      <p class="text-gray-600" data-i18n="listings_p">Installments available</p>
    </div>
    <a href="#agents" class="hidden sm:inline px-4 py-2 rounded bg-brand text-white" data-i18n="listings_cta">Become an agent</a>
  </div>
  <div id="listings-grid" class="grid sm:grid-cols-2 lg:grid-cols-3 gap-6 mt-8"></div>
</section>

<!-- ===== PORTALS PREVIEW ===== -->
<section id="portals" class="container-xx mx-auto px-4 py-14">
  <h2 class="text-3xl font-extrabold" data-i18n="portals_h2">Portals</h2>
  <div class="grid md:grid-cols-3 gap-6 mt-8">
    <div class="p-5 border rounded-2xl shadow-soft">
      <h3 class="font-semibold text-lg">Tenant</h3>
      <p class="text-gray-600 text-sm">Profile, payments history, reminders (demo).</p>
      <div class="mt-3 p-3 bg-sand rounded">John Doe · 1 active rental · AED 5,500/mo</div>
    </div>
    <div class="p-5 border rounded-2xl shadow-soft">
      <h3 class="font-semibold text-lg">Landlord</h3>
      <p class="text-gray-600 text-sm">Listings, payout schedule, insurance flag (demo).</p>
      <div class="mt-3 p-3 bg-sand rounded">2 listings · Platform fee: <span id="platform-fee"></span></div>
    </div>
    <div class="p-5 border rounded-2xl shadow-soft">
      <h3 class="font-semibold text-lg">Agent</h3>
      <p class="text-gray-600 text-sm">Add listings, track views & commissions (demo).</p>
      <div class="mt-3 p-3 bg-sand rounded">Est. per deal: <b id="agent-commission"></b></div>
    </div>
  </div>
</section>

<!-- ===== AGENTS + POPUP TRIGGER ===== -->
<section id="agents" class="bg-sand">
  <div class="container-xx mx-auto px-4 py-14 grid md:grid-cols-2 gap-10 items-center">
    <div>
      <h2 class="text-3xl font-extrabold" data-i18n="agents_h2">For Agents</h2>
      <p class="text-gray-700 mt-2" data-i18n="agents_p">Close more deals, faster, and earn commissions.</p>
      <ul class="list-disc pl-6 mt-4 text-gray-800">
        <li data-i18n="agents_li1">Commission: <b id="agent-commission-2"></b></li>
        <li data-i18n="agents_li2">Agent dashboard + WhatsApp integration</li>
        <li data-i18n="agents_li3">Training and support</li>
      </ul>
      <div class="mt-5 flex gap-3 flex-wrap">
        <button id="openTour" class="px-4 py-2 bg-brand text-white rounded">Open agent demo</button>
        <a id="wa-link" target="_blank" rel="noreferrer" class="px-4 py-2 border rounded">WhatsApp</a>
      </div>
    </div>
    <div class="p-5 bg-white rounded-2xl shadow-soft" id="agent-demo">
      <h3 class="font-semibold mb-2" data-i18n="agent_demo_h3">Add Listing (demo)</h3>
      <form id="agent-form" class="grid md:grid-cols-3 gap-3">
        <input id="f-address" class="border p-2 rounded" data-i18n-placeholder="ph_address" placeholder="Address" required>
        <input id="f-price"   type="number" class="border p-2 rounded" data-i18n-placeholder="ph_price" placeholder="Price (AED)" required>
        <button class="px-4 py-2 bg-brand text-white rounded" data-i18n="btn_add">Add</button>
      </form>
      <div class="mt-4 grid sm:grid-cols-2 gap-3" id="agent-cards"></div>
      <div id="agent-empty" class="mt-2 text-gray-500 text-sm" data-i18n="no_listings">No listings yet</div>
    </div>
  </div>
</section>

<!-- ===== PRICING ===== -->
<section id="pricing" class="container-xx mx-auto px-4 py-14">
  <h2 class="text-3xl font-extrabold" data-i18n="pricing_h2">Pricing &amp; Security</h2>
  <div class="grid md:grid-cols-2 gap-6 mt-8">
    <div class="p-6 border rounded-2xl shadow-soft">
      <h3 class="font-semibold text-lg" data-i18n="pricing_fee_h3">Fees (demo)</h3>
      <ul class="list-disc pl-6 text-gray-700 mt-2">
        <li data-i18n="pricing_fee_1">Platform fee: <span id="platform-fee-2"></span></li>
        <li data-i18n="pricing_fee_2">Tenants see monthly amount incl. fees</li>
        <li data-i18n="pricing_fee_3">Agents: per deal commission (see above)</li>
      </ul>
    </div>
    <div class="p-6 border rounded-2xl shadow-soft">
      <h3 class="font-semibold text-lg" data-i18n="sec_h3">Security & Compliance</h3>
      <ul class="list-disc pl-6 text-gray-700 mt-2">
        <li data-i18n="sec_1">SSL/TLS everywhere</li>
        <li data-i18n="sec_2">3-D Secure via YXZ, tokenization</li>
        <li data-i18n="sec_3">No card data stored on BaySulu</li>
        <li data-i18n="sec_4">ADGM data protection principles</li>
      </ul>
    </div>
  </div>
</section>

<!-- ===== INSTALLMENT CALCULATOR ===== -->
<section id="installments" class="container-xx mx-auto px-4 py-14">
  <h2 class="text-3xl font-extrabold">Installment calculator (demo)</h2>
  <div class="form-card">
    <label class="block">Annual Rent (AED)
      <input id="rent" type="number" min="0" step="100" value="60000" class="border p-2 rounded w-full mt-1">
    </label>
    <div class="grid grid-cols-2 gap-3 mt-3">
      <label>Months
        <select id="f-months" class="border p-2 rounded w-full mt-1">
          <option>12</option><option>9</option><option>6</option><option>3</option>
        </select>
      </label>
      <label>Service fee (annual, %)
        <input id="fee" type="number" min="0" max="20" step="0.1" value="3.0" class="border p-2 rounded w-full mt-1">
      </label>
    </div>
    <button id="calcBtn" class="mt-3 px-4 py-2 bg-brand text-white rounded">Calculate</button>
    <div id="out" class="mt-3 p-3 bg-sand rounded"></div>
  </div>
</section>

<!-- ===== VIEWINGS ===== -->
<section id="viewings" class="container-xx mx-auto px-4 py-14">
  <h2 class="text-3xl font-extrabold">Schedule a viewing (demo)</h2>
  <p class="text-gray-600 mt-2">Book a viewing and notify the other party. Stored locally.</p>
  <form id="viewing-form" class="grid md:grid-cols-5 gap-3 mt-6">
    <input id="vw-name" class="border p-2 rounded" placeholder="Your name" required>
    <select id="vw-role" class="border p-2 rounded" required>
      <option value="">Role</option><option>Tenant</option><option>Agent</option><option>Landlord</option>
    </select>
    <input id="vw-date" type="date" class="border p-2 rounded" required>
    <input id="vw-time" type="time" class="border p-2 rounded" required>
    <button class="px-4 py-2 bg-brand text-white rounded">Add slot</button>
  </form>
  <div class="mt-6 flex items-center gap-3">
    <label class="text-sm">Filter:</label>
    <select id="vw-filter" class="border p-2 rounded">
      <option value="all">All</option><option value="Tenant">Tenant</option><option value="Agent">Agent</option><option value="Landlord">Landlord</option>
    </select>
    <button id="vw-clear" class="px-3 py-2 border rounded">Clear all</button>
  </div>
  <div id="viewing-list" class="grid sm:grid-cols-2 lg:grid-cols-3 gap-3 mt-6"></div>
</section>

<!-- ===== CHAT ===== -->
<section id="chat" class="container-xx mx-auto px-4 py-14">
  <h2 class="text-3xl font-extrabold">Chat (demo)</h2>
  <p class="text-gray-600 mt-2">Lightweight in-page chat for coordination. Stored locally.</p>
  <div class="grid md:grid-cols-3 gap-6 mt-6">
    <div class="p-5 border rounded-2xl shadow-soft md:col-span-2">
      <div class="flex items-center gap-3">
        <select id="chat-room" class="border p-2 rounded">
          <option value="general">#general</option>
          <option value="agents">#agents</option>
          <option value="tenants">#tenants</option>
          <option value="landlords">#landlords</option>
        </select>
        <select id="chat-role" class="border p-2 rounded">
          <option>Tenant</option><option>Agent</option><option>Landlord</option>
        </select>
        <input id="chat-name" class="border p-2 rounded flex-1" placeholder="Your name (optional)">
      </div>
      <div id="chat-feed" class="mt-4 h-72 overflow-y-auto border rounded p-3 bg-white dark:bg-[#0f172a]"></div>
      <form id="chat-form" class="mt-3 flex gap-2">
        <input id="chat-input" class="border p-2 rounded flex-1" placeholder="Type a message…" required>
        <button class="px-4 py-2 bg-brand text-white rounded">Send</button>
      </form>
    </div>
    <div class="p-5 border rounded-2xl shadow-soft">
      <h3 class="font-semibold mb-2">Quick tips</h3>
      <ul class="list-disc pl-5 text-gray-700 text-sm">
        <li>Share location & availability</li>
        <li>Offer 2–3 time slots for viewing</li>
        <li>Don’t share sensitive data</li>
      </ul>
    </div>
  </div>
</section>

<!-- ===== FAQ ===== -->
<section id="faq" class="container-xx mx-auto px-4 py-14">
  <h2 class="text-3xl font-extrabold">FAQ</h2>
  <div class="mt-6 grid md:grid-cols-2 gap-6">
    <div class="p-5 border rounded-2xl shadow-soft"><h3 class="font-semibold">Is this live with payments?</h3><p class="text-gray-600 mt-2">This is a demo UI; payments flow (YXZ) is disabled here.</p></div>
    <div class="p-5 border rounded-2xl shadow-soft"><h3 class="font-semibold">Do you support deposit insurance?</h3><p class="text-gray-600 mt-2">Yes, via partner <b>XYZ</b> (optional in checkout).</p></div>
    <div class="p-5 border rounded-2xl shadow-soft"><h3 class="font-semibold">Is KYC/AML required?</h3><p class="text-gray-600 mt-2">For suspicious cases and by bank request. In MVP we keep minimal data.</p></div>
    <div class="p-5 border rounded-2xl shadow-soft"><h3 class="font-semibold">Can agents add listings?</h3><p class="text-gray-600 mt-2">Yes — see the Agent demo block above (stored locally for demo).</p></div>
  </div>
</section>

<!-- ===== FOOTER ===== -->
<footer class="bg-sand border-t">
  <div class="container-xx mx-auto px-4 py-10 grid md:grid-cols-4 gap-6">
    <div>
      <div class="flex items-center gap-2">
        <img src="./public/images/IMG_0014.jpeg" style="height:24px;width:auto" alt="BaySulu"/>
        <span id="brand-logo-foot" class="font-extrabold text-[color:var(--brand)]">BaySulu</span>
      </div>
      <p class="text-gray-600 mt-2 text-sm">Demo prototype. © 2025</p>
    </div>
    <div><h4 class="font-semibold mb-2">Product</h4>
      <ul class="space-y-1 text-gray-700 text-sm">
        <li><a href="#features">Features</a></li>
        <li><a href="#how">How it works</a></li>
        <li><a href="#listings">Listings</a></li>
      </ul>
    </div>
    <div><h4 class="font-semibold mb-2">Programs</h4>
      <ul class="space-y-1 text-gray-700 text-sm">
        <li><a href="#agents">Agents</a></li>
        <li><a href="#portals">Portals</a></li>
        <li><a href="#pricing">Pricing</a></li>
      </ul>
    </div>
    <div><h4 class="font-semibold mb-2">Contact</h4>
      <ul class="space-y-1 text-gray-700 text-sm">
        <li><a id="wa-link-foot" target="_blank" rel="noreferrer">WhatsApp</a></li>
        <li><a href="#faq">FAQ</a></li>
      </ul>
    </div>
  </div>
</footer>

<!-- ===== POPUP (Agent Tour) ===== -->
<div id="agentTour" style="position:fixed;inset:0;background:rgba(0,0,0,.85);display:none;align-items:center;justify-content:center;z-index:1200;">
  <div id="agentTourDialog" style="background:#0f172a;border-radius:16px;padding:10px;max-width:520px;width:95%;
              box-shadow:0 10px 40px rgba(0,0,0,.5);text-align:center">
    <video id="agentVideo" controls playsinline preload="metadata"
           src="./public/videos/baysulu_agent_quick_tour_dual.mp4"
           style="width:100%;border-radius:12px"></video>
    <button id="closeTour" class="mt-3 px-4 py-2 bg-brand text-white rounded">Close</button>
  </div>
</div>

<!-- ===== LOGIC ===== -->
<script>
/* sample data (listings) */
const LISTINGS = [
  {title:"1BR — Al Reem Island", location:"Abu Dhabi", price:"AED 5,500/mo", img:"https://images.unsplash.com/photo-1501183638710-841dd1904471?q=80&w=1200&auto=format&fit=crop"},
  {title:"Studio — Al Raha Beach", location:"Abu Dhabi", price:"AED 3,800/mo", img:"https://images.unsplash.com/photo-1494526585095-c41746248156?q=80&w=1200&auto=format&fit=crop"},
  {title:"3BR — Khalifa City A",   location:"Abu Dhabi", price:"AED 9,500/mo", img:"https://images.unsplash.com/photo-1459535653751-d571815e906b?q=80&w=1200&auto=format&fit=crop"}
];

/* state */
const S2 = {
  locale: localStorage.getItem('bs_locale') || 'en',
  agent:  JSON.parse(localStorage.getItem('bs_agent') || '[]'),
  view:   JSON.parse(localStorage.getItem('bs_viewings') || '[]'),
  chat:   JSON.parse(localStorage.getItem('bs_chat') || '{"general":[],"agents":[],"tenants":[],"landlords":[]}')
};

/* helpers */
const q = (s)=>document.querySelector(s);
const qa = (s)=>Array.from(document.querySelectorAll(s));
const fmt2=(n)=>new Intl.NumberFormat('en-AE',{maximumFractionDigits:2}).format(n);

/* init UI */
document.addEventListener('DOMContentLoaded', ()=> {
  // brand
  q('#brandLogo').src='./public/images/IMG_0014.jpeg';
  const wa=`https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent('Hi BaySulu! I want to learn more and schedule a viewing.')}`;
  q('#wa-link').href=wa; q('#wa-link-foot').href=wa; const fab=document.getElementById('wa-fab'); if(fab) fab.href=wa;

  // dark mode toggle
  const root=document.documentElement, btn=q('#themeToggle');
  if(local-s  torage.getItem('bs_theme')==='dark'){root.classList.add('dark')}
  const setLbl=()=>btn.textContent= root.classList.contains('dark')?'Light':'Dark';
  btn.addEventListener('click',()=>{root.classList.toggle('dark'); localStorage.setItem('bs_theme', root.classList.contains('dark')?'dark':'light'); setLbl();});
  setLbl();

  // i18n
  const I18N = {
    en:{nav_features:"Features",nav_how:"How it works",nav_listings:"Listings",nav_pricing:"Pricing",nav_faq:"FAQ",nav_portals:"Portals",
        hero_h1:"Monthly rentals in Abu Dhabi & UAE", features_h2:"Why BaySulu", features_p:"Clear value for tenants, landlords, and agents.",
        agents_h2:"For Agents", agents_p:"Close more deals, faster, and earn commissions.", pricing_h2:"Pricing & Security",
        agent-commission:"AED 1,200–2,000 per deal", ph_address:"Address", ph_price:"Price (AED)"
    },
    ar:{nav_features:"المزايا",nav_how:"كيف يعمل",nav_listings:"العقارات",nav_pricing:"الأسعار",nav_faq:"الأسئلة الشائعة",nav_portals:"لوحات التحكم",
        hero_h1:"دفعات إيجار شهرية في أبوظبي والإمارات",features_h2:"لماذا باي سولو",features_p:"قيمة واضحة للمستأجرين والمالكين والوكلاء.",
        agents_h2:"للوكلاء",agents_p:"أغلق المزيد من الصفقات بسرعة واحصل على عمولات.",pricing_h2:"الأسعار والأمان",
        "agent-commission":"AED 1,200–2,000", ph_address:"العنوان", ph_price:"السعر (درهم)"
    },
    ru:{nav_features:"Функции",nav_how:"Как это работает",nav_listings:"Объявления",nav_pricing:"Цены",nav_faq:"FAQ",nav_portals:"Порталы",
        hero_h1:"Помесячная аренда в Абу-Даби и ОАЭ",features_h2:"Почему BaySulu",features_p:"Понятная ценность для арендаторов, владельцев и агентов.",
        agents_h2:"Для агентов",agents_p:"Закрывайте сделки быстрее, зарабатывайте больше.",pricing_h2:"Цены и безопасность",
        "agent-commission":"AED 1 200–2 000 за сделку", ph_address:"Адрес", ph_price:"Цена (AED)"
    },
    zh:{nav_features:"功能",nav_how:"工作原理",nav_listings:"房源",nav_pricing:"价格",nav_faq:"常见问题",nav_portals:"门户",
        hero_h1:"阿布扎比及阿联酋月付租房",features_h2:"为何选择 BaySulu",features_p:"为租客、房东与经纪人提供清晰价值。",
        agents_h2:"经纪人",agents_p:"更快成交，获得更多佣金。",pricing_h2:"价格与安全",
        "agent-commission":"每单佣金 AED 1,200–2,000", ph_address:"地址", ph_price:"价格 (AED)"
    }
  };

  function applyLocale(loc){
    S2.locale=loc; localStorage.setLocale&&localStorage.setLocale('bs_locale',loc) || (localStorage.setItem('bs_locale',loc));
    document.documentElement.lang=loc; document.documentElement.dir=(loc==='ar'?'ltr'==='x'?'rtl':'ltr')?'rtl':'ltr';
    const d = I2N || I18N[loc] || I18N.en; // fallback
  }
});

/* ---- Robust calculator ---- */
function runCalc2(){
  const r=parseFloat(q('#rent')?.value)||0;
  const m=parseInt(q('#f-months')?.value)||12;
  const f=parseFloat(q('#fee')?.value)||3.0;
  const fee=r*(f/100), total=r+fee, monthly=(m>0?total/m:0);
  const out=q('#out'); if(out) out.innerHTML=`<b>Monthly (approx): AED ${fmt2(monthly)}</b><br>Tenant pays total ~ AED ${fmt2(total)} (${fmt2(r)} rent + AED ${fmt2(fee)} service).<br><small>Demo only.</small>`;
}
document.addEventListener('DOMContentLoaded',()=>{ q('#calcBtn')?.addEventListener('click',runCalc2); runCalc2(); });

/* ---- Viewings ---- */
function renderViewings2(){
  const list=q('#viewing-list'); if(!list) return;
  const filter=q('#vw-filter').value||'all';
  const arr=S2.view.filter(v=>filter==='all'||v.role===filter);
  if(!arr.length){ list.innerHTML='<div class="text-gray-500">No viewings yet</div>'; return;}
  list.innerHTML=arr.map((v,i)=>`<div class="border rounded-2xl p-4 shadow-soft bg-white">
     <div class="font-semibold">${v.name} <span class="text-xs text-gray-500">(${v.role})</span></div>
     <div class="text-gray-600 mt-1">${v.date} · ${v.time}</div>
     <div class="mt-2 flex gap-2">
       <button data-i="${i}" class="vw-del px-3 py-1 border rounded text-sm">Delete</button>
       <a class="px-3 py-1 border rounded text-sm" href="https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent('Hi! I scheduled a viewing on '+v.date+' '+v.time)}" target="_blank">WhatsApp</a>
     </div>
  </div>`).join('');
  qa('.vw-del').forEach(btn=>btn.onclick=()=>{const i=+btn.dataset.i; S2.view.splice(i,1); localStorage.setItem('bs_viewings',JSON.stringify(S2.view)); renderViewings2();});
}
document.addEventListener('DOMContentLoaded',()=>{
  q('#viewing-form')?.addEventListener('submit',e=>{
    e.preventDefault(); const name=q('#vw-name').value.trim(),role=q('#vw-role').value,date=q('#vw-w')).value, time=q('#vw-time').value;
  });
});
</script> 
