 <!doctype html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <title>BaySulu ‚Äî Monthly Rentals UAE (XL+)</title>

  <!-- Fonts & Tailwind -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet"/>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>tailwind.config={theme:{extend:{fontFamily:{sans:['Inter','system-ui','sans-serif']},colors:{brand:'#16543C',sand:'#F7F5EF',ink:'#0B1F1A'}}}};</script>

  <style>
    :root{--brand:#16543C;--sand:#F7F5EF;--ink:#0B1F1A}
    body{font-family:Inter,system-ui,sans-serif}
    .container-xx{max-width:1180px}
    .chip{padding:.25rem .6rem;border-radius:999px;font-size:.75rem}
    .badge{display:inline-block;padding:.4rem .6rem;border-radius:.6rem;font-size:.75rem}
    .nav-link{padding:.35rem .65rem;border-radius:.6rem}
    .nav-link.active{background:var(--brand);color:#fff}
    .shadow-soft{box-shadow:0 6px 18px rgba(0,0,0,.06)}
    .btn-light{background:#fff;color:#0b1220;border:1px solid #e5e7eb}
    .logo-img{height:56px;width:auto}
    @media (min-width:768px){.logo-img{height:72px}}
    .banner-text{font:14px/1.45 Inter,system-ui,sans-serif}
    .form-card{max-width:520px;margin:18px auto;padding:16px;border:1px solid #e5e7eb;border-radius:16px;background:#fff}
    .dark .form-card{background:#0f172a;border-color:#1f2937}

    /* WhatsApp FAB ‚Äî —Ñ–∏–∫—Å + iOS-safe */
    .wa-fab{
      position:fixed; inset:auto; right:12px; bottom:12px;
      width:60px;height:60px;border-radius:9999px;display:flex;align-items:center;justify-content:center;
      background:#25D366;color:#fff;box-shadow:0 10px 24px rgba(0,0,0,.25);z-index:99999;
      transform:translateZ(0); -webkit-transform:translateZ(0); touch-action:manipulation;
    }
    .wa-fab{ right:max(12px, env(safe-area-inset-right)); bottom:max(12px, env(safe-area-inset-bottom)) }
    @supports (bottom: constant(safe-area-inset-bottom)){
      .wa-fab{ right:max(12px, constant(safe-area-inset-right)); bottom:max(12px, constant(safe-area-inset-bottom)) }
    }
    @media (max-width:420px){ .wa-fab{width:56px;height:56px} }
    @media (min-width:768px){ .wa-fab{right:20px;bottom:20px;width:56px;height:56px} }

    /* AI Assistant */
    .ai-panel{position:fixed;right:12px;bottom:88px;width:min(90vw,360px);max-height:70vh;display:none;flex-direction:column;background:#fff;border:1px solid #e5e7eb;border-radius:16px;box-shadow:0 10px 24px rgba(0,0,0,.15);z-index:99990}
    .dark .ai-panel{background:#0f172a;border-color:#1f2937}
    .ai-head{display:flex;align-items:center;justify-content:space-between;padding:10px 12px;border-bottom:1px solid #e5e7eb}
    .dark .ai-head{border-color:#1f2937}
    .ai-feed{padding:10px 12px;overflow:auto;flex:1}
    .ai-form{display:flex;gap:8px;padding:10px 12px;border-top:1px solid #e5e7eb}
    .dark .ai-form{border-color:#1f2937}
    .ai-msg{margin:6px 0}
    .ai-user{color:#0b1220}.dark .ai-user{color:#e6e9ef}
    .ai-bot{color:#0b7a59}.dark .ai-bot{color:#4ad3a8}

    /* Dark mode ‚Äî –≤—Å—ë —á–∏—Ç–∞–µ–º–æ */
    .dark body{background:#0b1220;color:#e6e9ef}
    .dark .bg-sand{background:#0f172a}
    .dark .p-3,.dark .p-5,.dark .p-6{background:#0f172a!important}
    .dark .text-gray-600{color:#a7b0bd!important}
    .dark .text-gray-700{color:#c5cedb!important}
    .dark .badge,.dark .chip{background:#1f2937!important;color:#e6e9ef!important}
    .dark .demo-banner{background:#172036!important;border-color:#263043!important;color:#e6e9ef!important}
    .dark header{background:#0f172a!important;border-color:#1f2937!important}
    .dark .nav-link{color:#e6e9ef!important}
    .dark .nav-link:hover{background:rgba(236,253,245,.10)}
    .dark .btn-light{background:#e6e9ef!important;color:#0f172a!important;border-color:#334155!important}
    .dark header img{filter:contrast(1.08) saturate(1.08)}
  </style>
</head>
<body class="bg-white text-ink">

<!-- ===== Config (edit values only) ===== -->
<script>
  const BRAND_NAME="BaySulu";
  const TAG_EN="Pay monthly instead of 4‚Äì6 cheques.";
  const TAG_AR="ÿßÿØŸÅÿπ ÿ¥Ÿáÿ±ŸäŸãÿß ÿ®ÿØŸÑŸãÿß ŸÖŸÜ 4‚Äì6 ÿ¥ŸäŸÉÿßÿ™.";
  const WHATSAPP_NUMBER="971500000000";
  const AGENT_COMMISSION_TX="AED 1,200‚Äì2,000 per deal";
  const PLATFORM_FEE_TX="~4‚Äì5% platform fee (demo)";
</script>

<!-- ===== NAVBAR ===== -->
<header class="sticky top-0 z-50 border-b bg-white/90 backdrop-blur">
  <div class="container-xx mx-auto px-4 py-3 flex items-center justify-between">
    <a href="/" class="flex items-center gap-2">
      <img id="brandLogo" src="./public/images/IMG_0014.jpeg" alt="BaySulu" class="logo-img"
           onerror="this.style.display='none';document.getElementById('brandText').style.display='inline-block'"/>
      <span id="brandText" class="font-extrabold text-2xl" style="color:#16543C;display:none">BaySulu</span>
    </a>
    <nav class="hidden md:flex items-center gap-2">
      <a href="#features" class="nav-link" data-i18n="nav_features">Features</a>
      <a href="#how" class="nav-link" data-i18n="nav_how">How it works</a>
      <a href="#listings" class="nav-link" data-i18n="nav_listings">Listings</a>
      <a href="#portals" class="nav-link" data-i18n="nav_portals">Portals</a>
      <a href="#agents" class="nav-link" data-i18n="nav_agents">Agents</a>
      <a href="#pricing" class="nav-link" data-i18n="nav_pricing">Pricing</a>
      <a href="#installments" class="nav-link">Calculator</a>
      <a href="#viewings" class="nav-link">Viewings</a>
      <a href="#chat" class="nav-link">Chat</a>
      <a href="#faq" class="nav-link" data-i18n="nav_faq">FAQ</a>
    </nav>
    <div class="flex items-center gap-2">
      <button id="lang-en" class="px-2 py-1 border rounded">EN</button>
      <button id="lang-ar" class="px-2 py-1 border rounded">AR</button>
      <button id="lang-ru" class="px-2 py-1 border rounded">RU</button>
      <button id="lang-zh" class="px-2 py-1 border rounded">‰∏≠</button>
      <button id="themeToggle" class="px-2 py-1 border rounded">Dark</button>
    </div>
  </div>
</header>

<!-- ===== DEMO BANNER ===== -->
<div class="mx-auto container-xx px-4 mt-3">
  <div class="demo-banner rounded-xl p-3 border banner-text">
    <span id="banner-i18n">Demo only: This is a demonstration. All payments, calendars and chats are simulated (no backend).</span>
  </div>
</div>

<!-- ===== HERO ===== -->
<section class="relative overflow-hidden">
  <div class="absolute inset-0 bg-gradient-to-br from-emerald-600 via-emerald-700 to-brand"></div>
  <div class="container-xx relative z-10 mx-auto px-4 py-16 md:py-20 grid md:grid-cols-2 gap-10 items-center text-white">
    <div>
      <div class="chip bg-white/20">Fintech ¬∑ Rentals UAE</div>
      <h1 class="mt-4 text-4xl md:text-5xl font-extrabold leading-tight" data-i18n="hero_h1">Monthly rentals in Abu Dhabi &amp; UAE</h1>
      <p class="mt-4 text-white/90 text-lg" id="tagline">Pay monthly instead of 4‚Äì6 cheques.</p>
      <div class="mt-6 flex flex-wrap gap-3">
        <a href="#register" class="btn-light font-extrabold text-[18px] px-5 py-3 rounded-xl shadow-soft">Get started ‚Äî Join beta</a>
        <a href="#how" class="px-5 py-3 rounded-xl ring-1 ring-white/70 text-white" data-i18n="cta_secondary">How it works</a>
      </div>
      <div class="mt-6 flex flex-wrap gap-2 text-sm">
        <span class="badge bg-white/15">Secure payments via <b>YXZ</b> (3DS, tokenized)</span>
        <span class="badge bg-white/15">Optional deposit insurance by <b>XYZ</b></span>
      </div>
    </div>
    <div class="rounded-3xl shadow-soft overflow-hidden">
      <img class="w-full h-[320px] object-cover" alt="Abu Dhabi"
           src="https://images.unsplash.com/photo-1505691938895-1758d7feb511?q=80&w=1600&auto=format&fit=crop">
    </div>
  </div>
</section>

<!-- ===== TRUST ===== -->
<section class="bg-sand">
  <div class="container-xx mx-auto px-4 py-6 flex flex-wrap items-center gap-4 text-sm text-gray-600">
    <span class="chip bg-white shadow-soft">YXZ ¬∑ 3-D Secure</span>
    <span class="chip bg-white shadow-soft">XYZ ¬∑ Deposit Insurance</span>
    <span class="chip bg-white shadow-soft">SSL/TLS</span>
    <span class="chip bg-white shadow-soft">PCI scope minimized</span>
    <span class="chip bg-white shadow-soft">ADGM Data Protection</span>
  </div>
</section>

<!-- ===== FEATURES ===== -->
<section id="features" class="container-xx mx-auto px-4 py-14">
  <h2 class="text-3xl font-extrabold" data-i18n="features_h2">Why BaySulu</h2>
  <p class="text-gray-600 mt-2" data-i18n="features_p">Clear value for tenants, landlords, and agents.</p>
  <div class="grid md:grid-cols-3 gap-6 mt-8">
    <div class="p-5 border rounded-2xl shadow-soft">
      <div class="badge bg-brand/10 text-brand mb-3" data-i18n="f1_badge">Monthly plan</div>
      <h3 class="font-semibold text-lg" data-i18n="f1_h3">Pay monthly instead of cheques</h3>
      <p class="text-gray-600" data-i18n="f1_p">Auto-debit via YXZ; 3-D Secure for safety. No card data stored on BaySulu.</p>
    </div>
    <div class="p-5 border rounded-2xl shadow-soft">
      <div class="badge bg-brand/10 text-brand mb-3" data-i18n="f2_badge">Verified</div>
      <h3 class="font-semibold text-lg" data-i18n="f2_h3">Verified listings &amp; moderation</h3>
      <p class="text-gray-600" data-i18n="f2_p">Manual review at MVP stage. Quality photos and clear terms.</p>
    </div>
    <div class="p-5 border rounded-2xl shadow-soft">
      <div class="badge bg-brand/10 text-brand mb-3" data-i18n="f3_badge">Insurance</div>
      <h3 class="font-semibold text-lg" data-i18n="f3_h3">Deposit insurance (optional)</h3>
      <p class="text-gray-600" data-i18n="f3_p">Add policy via partner XYZ; landlords hand over keys with confidence.</p>
    </div>
  </div>
</section>

<!-- ===== HOW IT WORKS (VIDEO) ===== -->
<section id="how" class="container-xx mx-auto px-4 py-14">
  <div style="max-width:520px;margin:24px auto;text-align:center">
    <video controls playsinline preload="metadata"
           src="./public/videos/baysulu_how_it_works_dual.mp4"
           style="width:100%;border-radius:16px;border:1px solid #e5e7eb"></video>
    <small style="display:block;color:#6b7280;margin-top:6px">Browse ‚Üí Plan ‚Üí Checkout ‚Üí Chat ‚Üí Move-in (demo)</small>
  </div>
  <h2 class="text-3xl font-extrabold" data-i18n="how_h2">How it works</h2>
</section>

<!-- ===== REGISTRATION ===== -->
<section id="register" class="container-xx mx-auto px-4 py-14">
  <h2 class="text-3xl font-extrabold" data-i18n="register_h2">Create your BaySulu account (demo)</h2>
  <div class="form-card">
    <form id="reg-form" class="grid md:grid-cols-2 gap-3">
      <input id="reg-name" class="border p-2 rounded" placeholder="Full name" required>
      <input id="reg-email" type="email" class="border p-2 rounded" placeholder="Email" required>
      <input id="reg-phone" class="border p-2 rounded" placeholder="Phone" required>
      <input id="reg-pass"  type="password" class="border p-2 rounded" placeholder="Password" required>
      <button class="px-4 py-2 bg-brand text-white rounded md:col-span-2">Register (demo)</button>
    </form>
    <div id="reg-ok" class="text-green-500 mt-2 hidden">‚úî Registered (demo). You can now book a viewing &amp; chat.</div>
  </div>
</section>

<!-- ===== LISTINGS ===== -->
<section id="listings" class="container-xx mx-auto px-4 py-14">
  <div class="flex items-end justify-between">
    <div>
      <h2 class="text-3xl font-extrabold" data-i18n="listings_h2">Featured listings</h2>
      <p class="text-gray-600" data-i18n="listings_p">Installments available</p>
    </div>
    <a href="#agents" class="hidden sm:inline px-4 py-2 rounded bg-brand text-white" data-i18n="listings_cta">Become an agent</a>
  </div>
  <div id="listings-grid" class="grid sm:grid-cols-2 lg:grid-cols-3 gap-6 mt-8"></div>
</section>

<!-- ===== PORTALS PREVIEW ===== -->
<section id="portals" class="container-xx mx-auto px-4 py-14">
  <h2 class="text-3xl font-extrabold" data-i18n="portals_h2">Portals</h2>
  <div class="grid md:grid-cols-3 gap-6 mt-8">
    <div class="p-5 border rounded-2xl shadow-soft">
      <h3 class="font-semibold text-lg">Tenant</h3>
      <p class="text-gray-600 text-sm">Profile, payments history, reminders (demo).</p>
      <div class="mt-3 p-3 bg-sand rounded">John Doe ¬∑ 1 active rental ¬∑ AED 5,500/mo</div>
    </div>
    <div class="p-5 border rounded-2xl shadow-soft">
      <h3 class="font-semibold text-lg">Landlord</h3>
      <p class="text-gray-600 text-sm">Listings, payout schedule, insurance flag (demo).</p>
      <div class="mt-3 p-3 bg-sand rounded">2 listings ¬∑ Platform fee: <span id="platform-fee"></span></div>
    </div>
    <div class="p-5 border rounded-2xl shadow-soft">
      <h3 class="font-semibold text-lg">Agent</h3>
      <p class="text-gray-600 text-sm">Add listings, track views &amp; commissions (demo).</p>
      <div class="mt-3 p-3 bg-sand rounded">Est. per deal: <b id="agent-commission"></b></div>
    </div>
  </div>
</section>

<!-- ===== AGENTS + POPUP ===== -->
<section id="agents" class="bg-sand">
  <div class="container-xx mx-auto px-4 py-14 grid md:grid-cols-2 gap-10 items-center">
    <div>
      <h2 class="text-3xl font-extrabold" data-i18n="agents_h2">For Agents</h2>
      <p class="text-gray-700 mt-2" data-i18n="agents_p">Close more deals, faster, and earn commissions.</p>
      <ul class="list-disc pl-6 mt-4 text-gray-800">
        <li data-i18n="agents_li1">Commission: <b id="agent-commission-2"></b></li>
        <li data-i18n="agents_li2">Agent dashboard + WhatsApp integration</li>
        <li data-i18n="agents_li3">Training and support</li>
      </ul>
      <div class="mt-5 flex gap-3 flex-wrap">
        <button id="openTour" class="px-4 py-2 bg-brand text-white rounded">Open agent demo</button>
        <a id="wa-link" target="_blank" rel="noreferrer" class="px-4 py-2 border rounded">WhatsApp</a>
      </div>
    </div>
    <div class="p-5 bg-white rounded-2xl shadow-soft" id="agent-demo">
      <h3 class="font-semibold mb-2" data-i18n="agent_demo_h3">Add Listing (demo)</h3>
      <form id="agent-form" class="grid md:grid-cols-3 gap-3">
        <input id="f-address" class="border p-2 rounded" data-i18n-placeholder="ph_address" placeholder="Address" required>
        <input id="f-price" type="number" class="border p-2 rounded" data-i18n-placeholder="ph_price" placeholder="Price (AED)" required>
        <button class="px-4 py-2 bg-brand text-white rounded" data-i18n="btn_add">Add</button>
      </form>
      <div class="mt-4 grid sm:grid-cols-2 gap-3" id="agent-cards"></div>
      <div id="agent-empty" class="mt-2 text-gray-500 text-sm" data-i18n="no_listings">No listings yet</div>
    </div>
  </div>
</section>

<!-- ===== PRICING ===== -->
<section id="pricing" class="container-xx mx-auto px-4 py-14">
  <h2 class="text-3xl font-extrabold" data-i18n="pricing_h2">Pricing &amp; Security</h2>
  <div class="grid md:grid-cols-2 gap-6 mt-8">
    <div class="p-6 border rounded-2xl shadow-soft">
      <h3 class="font-semibold text-lg" data-i18n="pricing_fee_h3">Fees (demo)</h3>
      <ul class="list-disc pl-6 text-gray-700 mt-2">
        <li data-i18n="pricing_fee_1">Platform fee: <span id="platform-fee-2"></span></li>
        <li data-i18n="pricing_fee_2">Tenants see monthly amount incl. fees</li>
        <li data-i18n="pricing_fee_3">Agents: per deal commission (see above)</li>
      </ul>
    </div>
    <div class="p-6 border rounded-2xl shadow-soft">
      <h3 class="font-semibold text-lg" data-i18n="sec_h3">Security &amp; Compliance</h3>
      <ul class="list-disc pl-6 text-gray-700 mt-2">
        <li data-i18n="sec_1">SSL/TLS everywhere</li>
        <li data-i18n="sec_2">3-D Secure via YXZ, tokenization</li>
        <li data-i18n="sec_3">No card data stored on BaySulu</li>
        <li data-i18n="sec_4">ADGM data protection principles</li>
      </ul>
    </div>
  </div>
</section>

<!-- ===== CALCULATOR ===== -->
<section id="installments" class="container-xx mx-auto px-4 py-14">
  <h2 class="text-3xl font-extrabold">Installment calculator (demo)</h2>
  <div class="form-card">
    <label class="block">Annual Rent (AED)
      <input id="rent" type="number" min="0" step="100" value="60000" class="border p-2 rounded w-full mt-1">
    </label>
    <div class="grid grid-cols-2 gap-3 mt-3">
      <label>Months
        <select id="months" class="border p-2 rounded w-full mt-1">
          <option>12</option><option>9</option><option>6</option><option>3</option>
        </select>
      </label>
      <label>Service fee (annual, %)
        <input id="fee" type="number" min="0" max="20" step="0.1" value="3.0" class="border p-2 rounded w-full mt-1">
      </label>
    </div>
    <button id="calcBtn" class="mt-3 px-4 py-2 bg-brand text-white rounded">Calculate</button>
    <div id="out" class="mt-3 p-3 bg-sand rounded"></div>
  </div>
</section>

<!-- ===== VIEWINGS ===== -->
<section id="viewings" class="container-xx mx-auto px-4 py-14">
  <h2 class="text-3xl font-extrabold">Schedule a viewing (demo)</h2>
  <p class="text-gray-600 mt-2">Book a viewing and notify the other party. Stored locally.</p>
  <form id="viewing-form" class="grid md:grid-cols-5 gap-3 mt-6">
    <input id="vw-name" class="border p-2 rounded" placeholder="Your name" required>
    <select id="vw-role" class="border p-2 rounded" required>
      <option value="">Role</option><option>Tenant</option><option>Agent</option><option>Landlord</option>
    </select>
    <input id="vw-date" type="date" class="border p-2 rounded" required>
    <input id="vw-time" type="time" class="border p-2 rounded" required>
    <button class="px-4 py-2 bg-brand text-white rounded">Add slot</button>
  </form>
  <div class="mt-6 flex items-center gap-3">
    <label class="text-sm">Filter:</label>
    <select id="vw-filter" class="border p-2 rounded">
      <option value="all">All</option><option value="Tenant">Tenant</option><option value="Agent">Agent</option><option value="Landlord">Landlord</option>
    </select>
    <button id="vw-clear" class="px-3 py-2 border rounded">Clear all</button>
  </div>
  <div id="viewing-list" class="grid sm:grid-cols-2 lg:grid-cols-3 gap-3 mt-6"></div>
</section>

<!-- ===== CHAT ===== -->
<section id="chat" class="container-xx mx-auto px-4 py-14">
  <h2 class="text-3xl font-extrabold">Chat (demo)</h2>
  <p class="text-gray-600 mt-2">Lightweight in-page chat for coordination. Stored locally.</p>
  <div class="grid md:grid-cols-3 gap-6 mt-6">
    <div class="p-5 border rounded-2xl shadow-soft md:col-span-2">
      <div class="flex items-center gap-3">
        <select id="chat-room" class="border p-2 rounded">
          <option value="general">#general</option>
          <option value="agents">#agents</option>
          <option value="tenants">#tenants</option>
          <option value="landlords">#landlords</option>
        </select>
        <select id="chat-role" class="border p-2 rounded">
          <option>Tenant</option><option>Agent</option><option>Landlord</option>
        </select>
        <input id="chat-name" class="border p-2 rounded flex-1" placeholder="Your name (optional)">
      </div>
      <div id="chat-feed" class="mt-4 h-72 overflow-y-auto border rounded p-3 bg-white dark:bg-[#0f172a]"></div>
      <form id="chat-form" class="mt-3 flex gap-2">
        <input id="chat-input" class="border p-2 rounded flex-1" placeholder="Type a message‚Ä¶" required>
        <button class="px-4 py-2 bg-brand text-white rounded">Send</button>
      </form>
    </div>
    <div class="p-5 border rounded-2xl shadow-soft">
      <h3 class="font-semibold mb-2">Quick tips</h3>
      <ul class="list-disc pl-5 text-gray-700 text-sm">
        <li>Share location & availability</li>
        <li>Offer 2‚Äì3 time windows</li>
        <li>Don‚Äôt share sensitive data</li>
      </ul>
    </div>
  </div>
</section>

<!-- ===== FEEDBACK ===== -->
<section id="feedback" class="container-xx mx-auto px-4 py-14">
  <h2 class="text-3xl font-extrabold" data-i18n="fb_h2">Feedback</h2>
  <div class="form-card">
    <form id="fb-form" class="grid md:grid-cols-2 gap-3">
      <select id="fb-rating" class="border p-2 rounded" required>
        <option value="">Rating</option><option>‚òÖ‚òÜ‚òÜ‚òÜ‚òÜ</option><option>‚òÖ‚òÖ‚òÜ‚òÜ‚òÜ</option><option>‚òÖ‚òÖ‚òÖ‚òÜ‚òÜ</option><option>‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ</option><option>‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</option>
      </select>
      <input id="fb-name" class="border p-2 rounded" placeholder="Your name (optional)">
      <textarea id="fb-msg" class="border p-2 rounded md:col-span-2" rows="4" placeholder="Your message" required></textarea>
      <button class="px-4 py-2 bg-brand text-white rounded md:col-span-2">Send feedback (demo)</button>
    </form>
    <div id="fb-ok" class="text-green-500 mt-2 hidden">‚úî Thanks! Stored locally (demo).</div>
  </div>
</section>

<!-- ===== FOOTER ===== -->
<footer class="bg-sand border-t">
  <div class="container-xx mx-auto px-4 py-10 grid md:grid-cols-4 gap-6">
    <div>
      <div class="flex items-center gap-2">
        <img src="./public/images/IMG_0014.jpeg" style="height:24px;width:auto" alt="BaySulu"/>
        <span id="brand-logo-foot" class="font-extrabold" style="color:#16543C">BaySulu</span>
      </div>
      <p class="text-gray-600 mt-2 text-sm">Demo prototype. ¬© 2025</p>
    </div>
    <div><h4 class="font-semibold mb-2">Product</h4>
      <ul class="space-y-1 text-gray-700 text-sm">
        <li><a href="#features">Features</a></li>
        <li><a href="#how">How it works</a></li>
        <li><a href="#listings">Listings</a></li>
      </ul>
    </div>
    <div><h4 class="font-semibold mb-2">Programs</h4>
      <ul class="space-y-1 text-gray-700 text-sm">
        <li><a href="#agents">Agents</a></li>
        <li><a href="#portals">Portals</a></li>
        <li><a href="#pricing">Pricing</a></li>
      </ul>
    </div>
    <div><h4 class="font-semibold mb-2">Contact</h4>
      <ul class="space-y-1 text-gray-700 text-sm">
        <li><a id="wa-link-foot" target="_blank" rel="noreferrer">WhatsApp</a></li>
        <li><a href="#faq">FAQ</a></li>
      </ul>
    </div>
  </div>
</footer>

<!-- ===== POPUP (Agent Tour) ===== -->
<div id="agentTour" style="position:fixed;inset:0;background:rgba(0,0,0,.85);display:none;align-items:center;justify-content:center;z-index:1200;">
  <div id="agentTourDialog" style="background:#0f172a;border-radius:16px;padding:10px;max-width:520px;width:95%;box-shadow:0 10px 40px rgba(0,0,0,.5);text-align:center">
    <video id="agentVideo" controls playsinline preload="metadata"
           src="./public/videos/baysulu_agent_quick_tour_dual.mp4"
           style="width:100%;border-radius:12px"></video>
    <button id="closeTour" class="mt-3 px-4 py-2 bg-brand text-white rounded">Close</button>
  </div>
</div>

<!-- ===== AI Assistant (on-device) ===== -->
<button id="ai-fab" aria-label="AI Assistant"
        style="position:fixed;left:12px;bottom:12px;width:56px;height:56px;border-radius:9999px;
               display:flex;align-items:center;justify-content:center;background:#16543C;color:#fff;
               box-shadow:0 10px 24px rgba(0,0,0,.25);z-index:99999">
  AI
</button>
<div id="ai" class="ai-panel">
  <div class="ai-head">
    <strong>BaySulu Assistant (demo)</strong>
    <button id="ai-close" class="px-2 py-1 border rounded">√ó</button>
  </div>
  <div id="ai-feed" class="ai-feed"></div>
  <form id="ai-form" class="ai-form">
    <input id="ai-input" class="border rounded flex-1 p-2" placeholder="Ask about payouts, agent fees, insurance‚Ä¶">
    <button class="px-3 py-2 bg-brand text-white rounded">Ask</button>
  </form>
</div>

<!-- ===== LOGIC ===== -->
<script>
const I18N={
  en:{nav_features:"Features",nav_how:"How it works",nav_listings:"Listings",nav_agents:"Agents",nav_pricing:"Pricing",nav_faq:"FAQ",nav_portals:"Portals",
      hero_h1:"Monthly rentals in Abu Dhabi & UAE",features_h2:"Why BaySulu",features_p:"Clear value for tenants, landlords, and agents.",
      f1_badge:"Monthly plan",f1_h3:"Pay monthly instead of cheques",f1_p:"Auto-debit via YXZ; 3-D Secure for safety. No card data stored on BaySulu.",
      f2_badge:"Verified",f2_h3:"Verified listings & moderation",f2_p:"Manual review at MVP stage. Quality photos and clear terms.",
      f3_badge:"Insurance",f3_h3:"Deposit insurance (optional)",f3_p:"Partner XYZ; keys with confidence.",
      how_h2:"How it works",listings_h2:"Featured listings",listings_p:"Installments available",listings_cta:"Become an agent",
      portals_h2:"Portals",agents_h2:"For Agents",agents_p:"Close more deals, faster, and earn commissions.",
      agents_li1:"Commission: ",agents_li2:"Agent dashboard + WhatsApp integration",agents_li3:"Training and support",
      agent_demo_h3:"Add Listing (demo)",pricing_h2:"Pricing & Security",pricing_fee_h3:"Fees (demo)",pricing_fee_1:"Platform fee: ",pricing_fee_2:"Tenants see monthly amount incl. fees",pricing_fee_3:"Agents: per deal commission (see above)",
      sec_h3:"Security & Compliance",sec_1:"SSL/TLS everywhere",sec_2:"3-D Secure via YXZ, tokenization",sec_3:"No card data stored on BaySulu",sec_4:"ADGM data protection principles",
      register_h2:"Create your BaySulu account (demo)",fb_h2:"Feedback",ph_address:"Address",ph_price:"Price (AED)",no_listings:"No listings yet"},
  ar:{nav_features:"ÿßŸÑŸÖÿ≤ÿßŸäÿß",nav_how:"ŸÉŸäŸÅ ŸäÿπŸÖŸÑ",nav_listings:"ÿßŸÑÿπŸÇÿßÿ±ÿßÿ™",nav_agents:"ŸÑŸÑŸàŸÉŸÑÿßÿ°",nav_pricing:"ÿßŸÑÿ£ÿ≥ÿπÿßÿ±",nav_faq:"ÿßŸÑÿ£ÿ≥ÿ¶ŸÑÿ© ÿßŸÑÿ¥ÿßÿ¶ÿπÿ©",nav_portals:"ŸÑŸàÿ≠ÿßÿ™ ÿßŸÑÿ™ÿ≠ŸÉŸÖ",
      hero_h1:"ÿØŸÅÿπÿßÿ™ ÿ•Ÿäÿ¨ÿßÿ± ÿ¥Ÿáÿ±Ÿäÿ© ŸÅŸä ÿ£ÿ®Ÿàÿ∏ÿ®Ÿä ŸàÿßŸÑÿ•ŸÖÿßÿ±ÿßÿ™",features_h2:"ŸÑŸÖÿßÿ∞ÿß ÿ®ÿßŸä ÿ≥ŸàŸÑŸà",features_p:"ŸÇŸäŸÖÿ© Ÿàÿßÿ∂ÿ≠ÿ© ŸÑŸÑŸÖÿ≥ÿ™ÿ£ÿ¨ÿ±ŸäŸÜ ŸàÿßŸÑŸÖÿßŸÑŸÉŸäŸÜ ŸàÿßŸÑŸàŸÉŸÑÿßÿ°.",
      f1_badge:"ÿÆÿ∑ÿ© ÿ¥Ÿáÿ±Ÿäÿ©",f1_h3:"ÿßÿØŸÅÿπ ÿ¥Ÿáÿ±ŸäŸãÿß ÿ®ÿØŸÑ ÿßŸÑÿ¥ŸäŸÉÿßÿ™",f1_p:"ÿÆÿµŸÖ ÿ™ŸÑŸÇÿßÿ¶Ÿä ÿπÿ®ÿ± YXZÿõ ÿ≠ŸÖÿßŸäÿ© 3-D Secure. ŸÑÿß ŸÜÿÆÿ≤ŸÜ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ®ÿ∑ÿßŸÇÿßÿ™.",
      f2_badge:"ŸÖŸàÿ´ŸëŸÇ",f2_h3:"ŸÇŸàÿßÿ¶ŸÖ ŸÖŸàÿ´ŸëŸÇÿ© ŸàŸÖÿ±ÿßÿ¨ÿπÿ©",f2_p:"ŸÖÿ±ÿßÿ¨ÿπÿ© ŸäÿØŸàŸäÿ© ŸÅŸä ŸÖÿ±ÿ≠ŸÑÿ© MVP.",f3_badge:"ÿ™ÿ£ŸÖŸäŸÜ",f3_h3:"ÿ™ÿ£ŸÖŸäŸÜ ÿßŸÑŸàÿØŸäÿπÿ© (ÿßÿÆÿ™Ÿäÿßÿ±Ÿä)",f3_p:"ÿπÿ®ÿ± ÿßŸÑÿ¥ÿ±ŸäŸÉ XYZ.",
      how_h2:"ŸÉŸäŸÅ ŸäÿπŸÖŸÑ",listings_h2:"ÿπŸÇÿßÿ±ÿßÿ™ ŸÖŸÖŸäÿ≤ÿ©",listings_p:"ÿßŸÑÿ™ŸÇÿ≥Ÿäÿ∑ ŸÖÿ™ÿßÿ≠",listings_cta:"ŸÉŸÜ ŸàŸÉŸäŸÑÿßŸã",
      portals_h2:"ŸÑŸàÿ≠ÿßÿ™ ÿßŸÑÿ™ÿ≠ŸÉŸÖ",agents_h2:"ŸÑŸÑŸàŸÉŸÑÿßÿ°",agents_p:"ÿ£ÿ∫ŸÑŸÇ ÿßŸÑŸÖÿ≤ŸäÿØ ŸÖŸÜ ÿßŸÑÿµŸÅŸÇÿßÿ™ ÿ®ÿ≥ÿ±ÿπÿ© Ÿàÿßÿ≠ÿµŸÑ ÿπŸÑŸâ ÿπŸÖŸàŸÑÿßÿ™.",
      agents_li1:"ÿßŸÑÿπŸÖŸàŸÑÿ©: ",agents_li2:"ŸÑŸàÿ≠ÿ© ÿßŸÑŸàŸÉŸäŸÑ + Ÿàÿßÿ™ÿ≥ÿßÿ®",agents_li3:"ÿ™ÿØÿ±Ÿäÿ® ŸàÿØÿπŸÖ",
      agent_demo_h3:"ÿ•ÿ∂ÿßŸÅÿ© ÿπŸÇÿßÿ± (ÿ™ÿ¨ÿ±Ÿäÿ®Ÿä)",pricing_h2:"ÿßŸÑÿ£ÿ≥ÿπÿßÿ± ŸàÿßŸÑÿ£ŸÖÿßŸÜ",pricing_fee_h3:"ÿßŸÑÿ±ÿ≥ŸàŸÖ (ÿ™ÿ¨ÿ±Ÿäÿ®Ÿä)",pricing_fee_1:"ÿ±ÿ≥ŸàŸÖ ÿßŸÑŸÖŸÜÿµÿ©: ",pricing_fee_2:"ÿßŸÑŸÖÿ≥ÿ™ÿ£ÿ¨ÿ± Ÿäÿ±Ÿâ ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑÿ¥Ÿáÿ±Ÿä ÿ¥ÿßŸÖŸÑ ÿßŸÑÿ±ÿ≥ŸàŸÖ",pricing_fee_3:"ÿπŸÖŸàŸÑÿ© ÿßŸÑŸàŸÉŸäŸÑ",
      sec_h3:"ÿßŸÑÿ£ŸÖŸÜ ŸàÿßŸÑÿßŸÖÿ™ÿ´ÿßŸÑ",sec_1:"SSL/TLS ŸÅŸä ŸÉŸÑ ŸÖŸÉÿßŸÜ",sec_2:"3-D Secure",sec_3:"ŸÑÿß ŸÜÿÆÿ≤ŸÜ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ®ÿ∑ÿßŸÇÿßÿ™",sec_4:"ADGM",register_h2:"ÿ•ŸÜÿ¥ÿßÿ° ÿ≠ÿ≥ÿßÿ® (ÿ™ÿ¨ÿ±Ÿäÿ®Ÿä)",fb_h2:"ŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™",ph_address:"ÿßŸÑÿπŸÜŸàÿßŸÜ",ph_price:"ÿßŸÑÿ≥ÿπÿ± (ÿØÿ±ŸáŸÖ)",no_listings:"ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿπŸÇÿßÿ±ÿßÿ™ ÿ®ÿπÿØ"},
  ru:{nav_features:"–§—É–Ω–∫—Ü–∏–∏",nav_how:"–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç",nav_listings:"–û–±—ä—è–≤–ª–µ–Ω–∏—è",nav_agents:"–ê–≥–µ–Ω—Ç–∞–º",nav_pricing:"–¶–µ–Ω—ã",nav_faq:"FAQ",nav_portals:"–ü–æ—Ä—Ç–∞–ª—ã",
      hero_h1:"–ü–æ–º–µ—Å—è—á–Ω–∞—è –∞—Ä–µ–Ω–¥–∞ –≤ –ê–±—É-–î–∞–±–∏ –∏ –û–ê–≠",features_h2:"–ü–æ—á–µ–º—É BaySulu",features_p:"–ü–æ–Ω—è—Ç–Ω–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å –¥–ª—è –∞—Ä–µ–Ω–¥–∞—Ç–æ—Ä–æ–≤, –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤ –∏ –∞–≥–µ–Ω—Ç–æ–≤.",
      f1_badge:"–ü–æ–º–µ—Å—è—á–Ω—ã–π –ø–ª–∞–Ω",f1_h3:"–ü–ª–∞—Ç–∏—Ç–µ –ø–æ–º–µ—Å—è—á–Ω–æ –≤–º–µ—Å—Ç–æ —á–µ–∫–æ–≤",f1_p:"–ê–≤—Ç–æ—Å–ø–∏—Å–∞–Ω–∏–µ YXZ; 3-D Secure; –¥–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç –Ω–µ —Ö—Ä–∞–Ω–∏–º.",
      f2_badge:"–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ",f2_h3:"–ú–æ–¥–µ—Ä–∞—Ü–∏—è –æ–±—ä—è–≤–ª–µ–Ω–∏–π",f2_p:"–†—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —ç—Ç–∞–ø–µ MVP.",f3_badge:"–°—Ç—Ä–∞—Ö–æ–≤–∫–∞",f3_h3:"–°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –¥–µ–ø–æ–∑–∏—Ç–∞ (–æ–ø—Ü–∏—è)",f3_p:"–ü–∞—Ä—Ç–Ω—ë—Ä XYZ.",
      how_h2:"–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç",listings_h2:"–ò–∑–±—Ä–∞–Ω–Ω—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è",listings_p:"–î–æ—Å—Ç—É–ø–Ω–∞ —Ä–∞—Å—Å—Ä–æ—á–∫–∞",listings_cta:"–°—Ç–∞—Ç—å –∞–≥–µ–Ω—Ç–æ–º",
      portals_h2:"–ü–æ—Ä—Ç–∞–ª—ã",agents_h2:"–î–ª—è –∞–≥–µ–Ω—Ç–æ–≤",agents_p:"–ó–∞–∫—Ä—ã–≤–∞–π—Ç–µ —Å–¥–µ–ª–∫–∏ –±—ã—Å—Ç—Ä–µ–µ –∏ –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –±–æ–ª—å—à–µ.",
      agents_li1:"–ö–æ–º–∏—Å—Å–∏—è: ",agents_li2:"–ü–∞–Ω–µ–ª—å –∞–≥–µ–Ω—Ç–∞ + WhatsApp",agents_li3:"–û–±—É—á–µ–Ω–∏–µ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞",
      agent_demo_h3:"–î–æ–±–∞–≤–∏—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ (–¥–µ–º–æ)",pricing_h2:"–¶–µ–Ω—ã –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å",pricing_fee_h3:"–ö–æ–º–∏—Å—Å–∏–∏ (–¥–µ–º–æ)",pricing_fee_1:"–ö–æ–º–∏—Å—Å–∏—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã: ",pricing_fee_2:"–ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–µ—Å—è—á–Ω—É—é —Å—É–º–º—É —Å –∫–æ–º–∏—Å—Å–∏—è–º–∏",pricing_fee_3:"–ê–≥–µ–Ω—Ç–∞–º ‚Äî –∫–æ–º–∏—Å—Å–∏—è",
      sec_h3:"–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ",sec_1:"SSL/TLS",sec_2:"3-D Secure",sec_3:"–î–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç –Ω–µ —Ö—Ä–∞–Ω–∏–º",sec_4:"ADGM",
      register_h2:"–°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç (–¥–µ–º–æ)",fb_h2:"–û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å",ph_address:"–ê–¥—Ä–µ—Å",ph_price:"–¶–µ–Ω–∞ (AED)",no_listings:"–ü–æ–∫–∞ –Ω–µ—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏–π"},
  zh:{nav_features:"ÂäüËÉΩ",nav_how:"Â∑•‰ΩúÂéüÁêÜ",nav_listings:"ÊàøÊ∫ê",nav_agents:"ÁªèÁ∫™‰∫∫",nav_pricing:"‰ª∑Ê†º",nav_faq:"Â∏∏ËßÅÈóÆÈ¢ò",nav_portals:"Èó®Êà∑",
      hero_h1:"ÈòøÂ∏ÉÊâéÊØîÂèäÈòøËÅîÈÖãÊúà‰ªòÁßüÊàø",features_h2:"‰∏∫‰ΩïÈÄâÊã© BaySulu",features_p:"‰∏∫ÁßüÂÆ¢„ÄÅÊàø‰∏ú‰∏éÁªèÁ∫™‰∫∫Êèê‰æõÊ∏ÖÊô∞‰ª∑ÂÄº„ÄÇ",
      f1_badge:"Êúà‰ªòËÆ°Âàí",f1_h3:"ÊåâÊúàÊîØ‰ªòËÄåÈùûÊîØÁ•®",f1_p:"ÈÄöËøá YXZ Ëá™Âä®Êâ£Ê¨æÔºõ3-D Secure ÂÆâÂÖ®Ôºõ‰∏çÂ≠òÂÇ®Âç°Êï∞ÊçÆ„ÄÇ",
      f2_badge:"Â∑≤È™åËØÅ",f2_h3:"ÊàøÊ∫êÂÆ°Ê†∏",f2_p:"MVP Èò∂ÊÆµ‰∫∫Â∑•ÂÆ°Ê†∏„ÄÇ",f3_badge:"ÊäºÈáë‰øùÈô©",f3_h3:"ÂèØÈÄâÊäºÈáë‰øùÈô©",f3_p:"XYZ Âêà‰ΩúÊñπ„ÄÇ",
      how_h2:"Â∑•‰ΩúÂéüÁêÜ",listings_h2:"Á≤æÈÄâÊàøÊ∫ê",listings_p:"ÊîØÊåÅÂàÜÊúü",listings_cta:"Êàê‰∏∫ÁªèÁ∫™‰∫∫",portals_h2:"Èó®Êà∑",
      agents_h2:"ÁªèÁ∫™‰∫∫",agents_p:"Êõ¥Âø´Êàê‰∫§ÔºåËé∑ÂæóÊõ¥Â§ö‰Ω£Èáë„ÄÇ",agents_li1:"‰Ω£ÈáëÔºö",agents_li2:"ÁªèÁ∫™‰∫∫Èù¢Êùø + WhatsApp",agents_li3:"ÂüπËÆ≠‰∏éÊîØÊåÅ",
      agent_demo_h3:"Ê∑ªÂä†ÊàøÊ∫êÔºàÊºîÁ§∫Ôºâ",pricing_h2:"‰ª∑Ê†º‰∏éÂÆâÂÖ®",pricing_fee_h3:"Ë¥πÁî®ÔºàÊºîÁ§∫Ôºâ",pricing_fee_1:"Âπ≥Âè∞Ë¥πÔºö",pricing_fee_2:"Êúà‰ªòÈáëÈ¢ùÂê´Ë¥πÁî®",pricing_fee_3:"ÁªèÁ∫™‰∫∫‰Ω£Èáë",
      sec_h3:"ÂÆâÂÖ®‰∏éÂêàËßÑ",sec_1:"SSL/TLS",sec_2:"3-D Secure",sec_3:"‰∏çÂ≠òÂÇ®Èì∂Ë°åÂç°Êï∞ÊçÆ",sec_4:"ADGM",register_h2:"ÂàõÂª∫Ë¥¶Êà∑ÔºàÊºîÁ§∫Ôºâ",fb_h2:"ÂèçÈ¶à",ph_address:"Âú∞ÂùÄ",ph_price:"‰ª∑Ê†º (AED)",no_listings:"ÊöÇÊó†ÊàøÊ∫ê"}
};
const BANNER_TEXT={
  en:"Demo only: This is a demonstration. All payments, calendars and chats are simulated (no backend).",
  ar:"ŸÜÿ≥ÿÆÿ© ÿ™ÿ¨ÿ±Ÿäÿ®Ÿäÿ© ŸÅŸÇÿ∑: Ÿáÿ∞ÿß ÿπÿ±ÿ∂ ÿ™Ÿàÿ∂Ÿäÿ≠Ÿä. ÿ¨ŸÖŸäÿπ ÿßŸÑŸÖÿØŸÅŸàÿπÿßÿ™ ŸàÿßŸÑÿ™ŸÇÿßŸàŸäŸÖ ŸàÿßŸÑÿØÿ±ÿØÿ¥ÿ© ŸÖÿ≠ÿßŸÉÿßÿ© (ÿ®ÿØŸàŸÜ ÿÆÿßÿØŸÖ).",
  ru:"–î–µ–º–æ: —ç—Ç–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è. –í—Å–µ –ø–ª–∞—Ç–µ–∂–∏, –∫–∞–ª–µ–Ω–¥–∞—Ä–∏ –∏ —á–∞—Ç—ã –∏–º–∏—Ç–∏—Ä–æ–≤–∞–Ω—ã (–±–µ–∑ –±—ç–∫–µ–Ω–¥–∞).",
  zh:"‰ªÖÊºîÁ§∫ÔºöËøôÊòØÊºîÁ§∫ÁâàÊú¨„ÄÇÊâÄÊúâÊîØ‰ªò„ÄÅÊó•Á®ã‰∏éËÅäÂ§©Âùá‰∏∫Ê®°ÊãüÔºàÊó†ÂêéÁ´ØÔºâ„ÄÇ"
};

/* state */
const S={locale:localStorage.getItem('bs_locale')||'en',
         agent:JSON.parse(localStorage.getItem('bs_agent')||'[]'),
         view: JSON.parse(localStorage.getItem('bs_viewings')||'[]'),
         chat: JSON.parse(localStorage.getItem('bs_chat')||'{"general":[],"agents":[],"tenants":[],"landlords":[]}')};

const $=s=>document.querySelector(s), $$=s=>Array.from(document.querySelectorAll(s));
const fmt=n=>new Intl.NumberFormat('en-AE',{maximumFractionDigits:2}).format(n);

/* Brand & WA */
function applyBrand(){
  $('#platform-fee')  && ($('#platform-fee').textContent  = PLATFORM_FEE_TX);
  $('#platform-fee-2')&& ($('#platform-fee-2').textContent= PLATFORM_FEE_TX);
  $('#agent-commission')  && ($('#agent-commission').textContent  = AGENT_COMMISSION_TX);
  $('#agent-commission-2')&& ($('#agent-commission-2').textContent= AGENT_COMMISSION_TX);
  const wa=`https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent('Hi BaySulu! I want to learn more and schedule a viewing.')}`;
  $('#wa-link')?.setAttribute('href',wa); $('#wa-link-foot')?.setAttribute('href',wa);
  const fab=document.getElementById('wa-fab'); if(fab) fab.href=wa;
}

/* Locale */
function setLocale(loc){
  S.locale=loc; localStorage.setItem('bs_locale',loc);
  document.documentElement.lang=loc; document.documentElement.dir=(loc==='ar'?'rtl':'ltr');
  const d=I18N[loc]||I18N.en;
  $$('[data-i18n]').forEach(el=>{const k=el.getAttribute('data-i18n'); if(d[k]) el.textContent=d[k];});
  $$('[data-i18n-placeholder]').forEach(el=>{const k=el.getAttribute('data-i18n-placeholder'); if(d[k]) el.setAttribute('placeholder',d[k]);});
  const tl=$('#tagline'); if(tl) tl.textContent=(loc==='ar'?"ÿßÿØŸÅÿπ ÿ¥Ÿáÿ±ŸäŸãÿß ÿ®ÿØŸÑŸãÿß ŸÖŸÜ 4‚Äì6 ÿ¥ŸäŸÉÿßÿ™.":"Pay monthly instead of 4‚Äì6 cheques.");
  const b=$('.demo-banner'); if(b){ b.textContent=''; const s=document.createElement('span'); s.id='banner-i18n'; s.textContent=BANNER_TEXT[loc]||BANNER_TEXT.en; b.appendChild(s); }
  ;['en','ar','ru','zh'].forEach(k=>$('#lang-'+k)?.classList.toggle('font-bold',k===loc));
}

/* Listings */
function renderListings(){
  const grid=$('#listings-grid'); if(!grid) return;
  const LS=[
    {t:"1BR ‚Äî Al Reem Island",l:"Abu Dhabi",p:"AED 5,500/mo",img:"https://images.unsplash.com/photo-1501183638710-841dd1904471?q=80&w=1200&auto=format&fit=crop"},
    {t:"Studio ‚Äî Al Raha Beach",l:"Abu Dhabi",p:"AED 3,800/mo",img:"https://images.unsplash.com/photo-1494526585095-c41746248156?q=80&w=1200&auto=format&fit=crop"},
    {t:"3BR ‚Äî Khalifa City A", l:"Abu Dhabi",p:"AED 9,500/mo",img:"https://images.unsplash.com/photo-1459535653751-d571815e906b?q=80&w=1200&auto=format&fit=crop"}
  ];
  grid.innerHTML=LS.map(it=>`
    <div class="border rounded-2xl overflow-hidden shadow-soft bg-white">
      <img src="${it.img}" alt="${it.t}" class="w-full h-40 object-cover">
      <div class="p-4">
        <div class="chip bg-brand/10 text-brand mb-2">${S.locale==='ar'?'ÿßŸÑÿ™ŸÇÿ≥Ÿäÿ∑ ŸÖÿ™ÿßÿ≠':'Installments available'}</div>
        <h3 class="font-semibold">${it.t}</h3>
        <p class="text-gray-600">${it.l}</p>
        <p class="text-brand font-bold">${it.p}</p>
      </div>
    </div>`).join('');
}

/* Agent */
function renderAgent(){
  const wrap=$('#agent-cards'), empty=$('#agent-empty'); if(!wrap||!empty) return;
  empty.classList.toggle('hidden',S.agent.length>0);
  wrap.innerHTML=S.agent.map(x=>`
    <div class="border rounded-xl p-3">
      <div class="text-sm text-gray-500">${x.address}</div>
      <div class="font-semibold">AED ${fmt(+x.price||0)}</div>
      <div class="text-xs text-gray-500 mt-1">Added by agent</div>
    </div>`).join('');
}

/* Viewings */
function renderViewings(){
  const list=$('#viewing-list'); if(!list) return;
  const filter=$('#vw-filter')?.value||'all';
  const arr=S.view.filter(v=>filter==='all'?true:v.role===filter);
  if(!arr.length){ list.innerHTML='<div class="text-gray-500">No viewings yet</div>'; return; }
  list.innerHTML=arr.map((v,i)=>`
    <div class="border rounded-2xl p-4 shadow-soft bg-white">
      <div class="font-semibold">${v.name} <span class="text-xs text-gray-500">(${v.role})</span></div>
      <div class="text-gray-600 mt-1">${v.date} ¬∑ ${v.time}</div>
      <div class="mt-2 flex gap-2">
        <button data-i="${i}" class="vw-del px-3 py-1 border rounded text-sm">Delete</button>
        <a class="px-3 py-1 border rounded text-sm" href="https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent('Hi! I scheduled a viewing on '+v.date+' '+v.time)}" target="_blank" rel="noreferrer">WhatsApp</a>
      </div>
    </div>`).join('');
  $$('.vw-del').forEach(btn=>{
    btn.onclick=()=>{const i=+btn.getAttribute('data-i'); S.view.splice(i,1); localStorage.setItem('bs_viewings',JSON.stringify(S.view)); renderViewings();}
  });
}

/* Calculator */
function runCalc(){
  const r=parseFloat($('#rent')?.value)||0, m=parseInt($('#months')?.value)||12, f=parseFloat($('#fee')?.value)||3.0;
  const fee=r*(f/100), total=r+fee, monthly=(m>0?total/m:0);
  const out=$('#out'); if(out) out.innerHTML=`<b>Monthly (approx): AED ${fmt(monthly)}</b><br>Tenant pays total ~ AED ${fmt(total)} (${fmt(r)} rent + AED ${fmt(fee)} service).<br><small>Demo only. Rates/fees are illustrative.</small>`;
}

/* Chat */
function renderChat(){
  const room=$('#chat-room')?.value||'general', feed=$('#chat-feed'); if(!feed) return;
  const items=S.chat[room]||[];
  feed.innerHTML=items.map(m=>`
    <div class="mb-2">
      <span class="px-2 py-0.5 rounded bg-brand/10 text-brand text-xs">${m.role}${m.name?(' ¬∑ '+m.name):''}</span>
      <div class="mt-1">${m.text}</div>
      <div class="text-xs text-gray-500">${new Date(m.ts).toLocaleString()}</div>
    </div>`).join('');
  feed.scrollTop=feed.scrollHeight;
}

/* Popup (Agent tour) */
function setupPopup(){
  const openBtn=$('#openTour'), modal=$('#agentTour'), dialog=$('#agentTourDialog'), closeBtn=$('#closeTour'), video=$('#agentVideo');
  if(!modal||!openBtn) return;
  const open=(e)=>{e.preventDefault(); modal.style.display='flex'; document.body.style.overflow='hidden';};
  const close=()=>{modal.style.display='none'; document.body.style.overflow=''; try{video.pause();}catch(e){}};
  openBtn.addEventListener('click',open); closeBtn.addEventListener('click',close);
  modal.addEventListener('click',e=>{ if(!dialog.contains(e.target)) close(); });
  document.addEventListener('keydown',e=>{ if(e.key==='Escape' && modal.style.display==='flex') close(); });
}

/* AI-lite ‚Äî KB (EN/RU/AR/‰∏≠Êñá) */
const KB = [
  {lang:'en', q:'payouts flow', a:'Tenant pays monthly via bank; bank pays landlord upfront; agent commission & platform fees are split per agreement.'},
  {lang:'ru', q:'–∫–æ–º–∏—Å—Å–∏—è –∞–≥–µ–Ω—Ç–∞', a:'–ê–≥–µ–Ω—Ç —É–∫–∞–∑—ã–≤–∞–µ—Ç IBAN –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏; –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç –≤—ã–ø–ª–∞—Ç—É —á–µ—Ä–µ–∑ API –±–∞–Ω–∫–∞; –±–∞–Ω–∫ –ø–µ—Ä–µ—á–∏—Å–ª—è–µ—Ç –∞–≥–µ–Ω—Ç—É.'},
  {lang:'ar', q:'ŸáŸÑ ÿ™ÿÆÿ≤ŸÜ ÿßŸÑŸÖŸÜÿµÿ© ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ®ÿ∑ÿßŸÇÿßÿ™', a:'ŸÑÿß. ÿ™ŸÖÿ± ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ŸÑŸÑÿ®ŸÜŸÉ ÿπÿ®ÿ± API ŸàÿßŸÑÿ®ŸÜŸÉ ŸáŸà ŸÖŸÜ Ÿäÿ≠ŸÅÿ∏ ŸàŸäÿπÿßŸÑÿ¨ ÿßŸÑŸÖÿØŸÅŸàÿπÿßÿ™.'},
  {lang:'zh', q:'‰øùÈô© ÁªìÁÆó', a:'‰øùË¥πÁªèÈì∂Ë°åÊ∏ÖÂàÜÔºö‰øùÈô©ÂÖ¨Âè∏Âà∞Ë¥¶„ÄÅÂπ≥Âè∞Êî∂Âèñ‰Ω£Èáë„ÄÇ'},
  {lang:'en', q:'subscription fee', a:'Landlord subscription can be monthly or one-off; bank splits platform share automatically.'},
  {lang:'ru', q:'iban —Ö—Ä–∞–Ω–µ–Ω–∏–µ', a:'–í –ø–∞—Ä—Ç–Ω—ë—Ä—Å–∫–æ–π –º–æ–¥–µ–ª–∏ IBAN —Ö—Ä–∞–Ω–∏—Ç –±–∞–Ω–∫; –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ–¥–∞—ë—Ç —á–µ—Ä–µ–∑ API.'}
];
function _tok(s){return (s||'').toLowerCase().normalize('NFKD').replace(/[^\p{L}\p{N}]+/gu,' ').trim().split(/\s+/)}
function _score(q1,q2){const a=new Set(_tok(q1)),b=new Set(_tok(q2));if(!a.size||!b.size)return 0;let i=0;a.forEach(t=>b.has(t)&&i++);return i/Math.sqrt(a.size*b.size)}
function aiBest(query, lang){const pool=KB.filter(x=>x.lang===lang);const arr=pool.length?pool:KB;let best=null,bs=0;arr.forEach(x=>{const s=_score(query,x.q);if(s>bs){bs=s;best=x}});if(!best||bs<0.12)return lang==='ru'?'–£—Ç–æ—á–Ω–∏—Ç–µ –≤–æ–ø—Ä–æ—Å.':'Please clarify your question.';return best.a}

/* INIT */
document.addEventListener('DOMContentLoaded',()=>{
  applyBrand();

  // Dark
  const root=document.documentElement, btn=$('#themeToggle');
  if(localStorage.getItem('bs_theme')==='dark'){root.classList.add('dark')}
  const setLbl=()=>btn.textContent=root.classList.contains('dark')?'Light':'Dark';
  btn.addEventListener('click',()=>{root.classList.toggle('dark'); localStorage.setItem('bs_theme',root.classList.contains('dark')?'dark':'light'); setLbl();}); setLbl();

  // i18n
  setLocale(S.locale);
  $('#lang-en')?.addEventListener('click',()=>setLocale('en'));
  $('#lang-ar')?.addEventListener('click',()=>setLocale('ar'));
  $('#lang-ru')?.addEventListener('click',()=>setLocale('ru'));
  $('#lang-zh')?.addEventListener('click',()=>setLocale('zh'));

  // listings
  renderListings();

  // Registration
  $('#reg-form')?.addEventListener('submit',e=>{
    e.preventDefault();
    const user={name:$('#reg-name').value.trim(),email:$('#reg-email').value.trim(),phone:$('#reg-phone').value.trim(),pass:$('#reg-pass').value};
    if(!user.name||!user.email||!user.phone||!user.pass) return;
    const arr=JSON.parse(localStorage.getItem('bs_users')||'[]'); arr.unshift({...user,ts:Date.now()});
    localStorage.setItem('bs_users',JSON.stringify(arr));
    e.target.reset(); $('#reg-ok')?.classList.remove('hidden');
  });

  // Agent form
  $('#agent-form')?.addEventListener('submit',e=>{
    e.preventDefault();
    const addr=$('#f-address').value.trim(), price=$('#f-price').value.trim();
    if(!addr||!price) return alert('Fill address & price');
    S.agent.unshift({address:addr,price:price,ts:Date.now()});
    localStorage.setItem('bs_agent',JSON.stringify(S.agent));
    e.target.reset(); renderAgent();
  });
  renderAgent();

  // Calculator
  $('#calcBtn')?.addEventListener('click',runCalc); runCalc();

  // Viewings
  $('#viewing-form')?.addEventListener('submit',e=>{
    e.preventDefault();
    const name=$('#vw-name').value.trim(), role=$('#vw-role').value, date=$('#vw-date').value, time=$('#vw-time').value;
    if(!name||!role||!date||!time) return;
    S.view.unshift({name,role,date,time,ts:Date.now()});
    localStorage.setItem('bs_viewings',JSON.stringify(S.view));
    e.target.reset(); renderViewings();
  });
  $('#vw-filter')?.addEventListener('change',renderViewings);
  $('#vw-clear')?.addEventListener('click',()=>{ if(confirm('Clear all viewings?')){ S.view=[]; localStorage.setItem('bs_viewings','[]'); renderViewings(); }});
  renderViewings();

  // Chat
  $('#chat-form')?.addEventListener('submit',e=>{
    e.preventDefault();
    const room=$('#chat-room').value, role=$('#chat-role').value, name=$('#chat-name').value.trim(), text=$('#chat-input').value.trim();
    if(!text) return;
    S.chat[room]=S.chat[room]||[]; S.chat[room].push({role,name,text,ts:Date.now()});
    localStorage.setItem('bs_chat',JSON.stringify(S.chat));
    $('#chat-input').value=''; renderChat();
  });
  $('#chat-room')?.addEventListener('change',renderChat);
  renderChat();

  // Popup
  setupPopup();

  // Nav active
  document.addEventListener('click',e=>{
    const n=e.target.closest('.nav-link'); if(n){ $$('.nav-link').forEach(x=>x.classList.remove('active')); n.classList.add('active'); }
  });

  // AI open/close
  const aiPanel=$('#ai'); const aiFab=$('#ai-fab'); const aiClose=$('#ai-close'); const aiFeed=$('#ai-feed'); const aiForm=$('#ai-form'); const aiInput=$('#ai-input');
  aiFab?.addEventListener('click',()=>{ aiPanel.style.display='flex'; aiFeed.scrollTop=aiFeed.scrollHeight; });
  aiClose?.addEventListener('click',()=>{ aiPanel.style.display='none'; });
  aiForm?.addEventListener('submit',e=>{
    e.preventDefault();
    const q=(aiInput.value||'').trim(); if(!q) return;
    const lang=S.locale||'en';
    aiFeed.insertAdjacentHTML('beforeend', `<div class="ai-msg ai-user">üë§ ${q}</div>`);
    const a=aiBest(q, lang);
    aiFeed.insertAdjacentHTML('beforeend', `<div class="ai-msg ai-bot">ü§ñ ${a}</div>`);
    aiInput.value=''; aiFeed.scrollTop=aiFeed.scrollHeight;
  });
});

/* iOS anti-zoom for FAB (—Ç–æ–ª—å–∫–æ iOS Safari) */
(function(){
  const fab=document.getElementById('wa-fab');
  const iOS=/iPad|iPhone|iPod/.test(navigator.userAgent);
  if(!fab || !iOS || !window.visualViewport) return;
  function place(){
    const vv=visualViewport, size=fab.offsetWidth||56, m=12;
    fab.style.left=(vv.pageLeft+vv.width-size-m)+'px';
    fab.style.top =(vv.pageTop +vv.height-size-m)+'px';
    fab.style.right='auto'; fab.style.bottom='auto';
  }
  visualViewport.addEventListener('resize',place);
  visualViewport.addEventListener('scroll',place);
  window.addEventListener('load',place,{once:true});
})();
</script>

<!-- WhatsApp FAB -->
<a id="wa-fab" class="wa-fab" target="_blank" rel="noopener" aria-label="WhatsApp"
   href="https://wa.me/971500000000?text=Hi%20BaySulu!%20I%20want%20to%20learn%20more%20and%20schedule%20a%20viewing.">
  <svg viewBox="0 0 32 32" width="26" height="26" fill="currentColor" aria-hidden="true">
    <path d="M19.11 17.44c-.29-.15-1.7-.84-1.96-.94-.26-.1-.45-.15-.64.15-.19.29-.74.94-.91 1.13-.17.19-.34.22-.63.07-.29-.15-1.2-.44-2.28-1.4-.84-.75-1.41-1.67-1.58-1.96-.17-.29-.02-.45.13-.6.13-.13.29-.34.44-.52.15-.17.19-.29.29-.48.1-.19.05-.37-.02-.52-.07-.15-.64-1.54-.88-2.11-.23-.56-.47-.48-.64-.49h-.55c-.19 0-.5.07-.76.37-.26.29-1 1-1 2.45 0 1.45 1.03 2.85 1.18 3.04.15.19 2.03 3.1 4.93 4.35.69.3 1.23.48 1.65.61.69.22 1.31.19 1.8.11.55-.08 1.7-.69 1.94-1.35.24-.67.24-1.24.17-1.35-.07-.11-.26-.18-.55-.33z"/>
    <path d="M26.67 5.33C24.13 2.8 20.8 1.33 17.33 1.33 9.84 1.33 3.87 7.3 3.87 14.79l-1.5 7.34 7.21-2.53c1.52.98 3.3 1.49 5.14 1.49 6.22 0 11.26-4.9 11.26-10.94 0-2.9-1.13-5.53-3.11-7.27z"/>
  </svg>
</a>

</body>
</html>
